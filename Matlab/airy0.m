function [Z_N] = airy0(K,N)
%% *purpose*
% Calculates the  negative zeros of the Airy functions Ai(Z) or Bi(Z) or
% the negative zeros of the derivative Airy functions Ai'(Z)=0 or Bi'(Z)=0.
% Ai(Z), Ai'(Z) have zeros on the negative real axis only. Bi(Z) and Bi'(Z)
% have zeros on the netagive real axis and in the sector [pi/3< |Z| < pi/2]
% This function returns the negative zeros.
%% *inputs*
% K	- type of Airy function
%     K=0 zeros of Airy function, Ai(Z), which is the same as airy(Z).
%     K=1 zeros of 1st derivative of Airy function, Ai'(Z).
%     K=2 zeros of Airy function of the second kind,Bi(Z)
%     K=3 zeros of 1st derivative of Airy function of the second kind, Bi'(Z)
% N - index of the zero (vectorized)
%% *outputs*
% Z_N - the Nth value of Z such that airy(Z) = 0 (real numbers)
%% *reference* 
% The first 20 values are pretabulated. Values for indices larger 
% than 20 are calculated using equations 10.4.94) etc. on page 450 of
% Abramowitz and Stegun, Handbook of Functions
% Pretabulated values are given on page 478.
%% *history
% 2021/03/14  mnoah  PI-Day Project
%% *start*
% roots of Ai
Ai0 = [ ...
    -2.33810741045976703848919725244673544063854014567, ...
    -4.0879494441309706166369887014573910602247646991085, ...
    -5.5205598280955510591298555129312935737972142806175, ...
    -6.7867080900717589987802463844961769660538824773935, ...
    -7.9441335871208531231382805557982685321406743969722, ...
    -9.0226508533409803801581908398800892565246775351561, ...
    -10.040174341558085930594556737362518094042902569106, ...
    -11.008524303733262893235439649590151016730825381504, ...
    -11.93601556323626251700636490293058431557788623212, ...
    -12.828776752865757200406729407241824477386415599573, ...
    -13.691489035210717928295696779466920541665369809201, ...
    -14.527829951775334982073981442995893378714164869835, ...
    -15.340755135977996857146208513481486705117583320248, ...
    -16.132685156945771439345980447202521790518272397076, ...
    -16.905633997429942627035238770611476599090051095032, ...
    -17.66130010569705750925365030401805595215321866812, ...
    -18.40113259920711541586139792950433675459381460602, ...
    -19.126380474246952144124148689732494689075458384753, ...
    -19.838129891721499700947563616011404198335682494539, ...
    -20.537332907677566359982681411308101745304218014737];

% roots of Bi
Bi0 = [ ...
    -1.17371322270912792491997996247390210454364638918, ...
    -3.2710933028363527156802282401664138063009359691003, ...
    -4.830737841662015932667709339905178176966142617323, ...
    -6.1698521283102512598333645205559366799655494342756, ...
    -7.3767620793677637135999593304425412220915222993971, ...
    -8.4919488465093880134480394928097767286050875550555, ...
    -9.5381943793462388866329885451560196208390720763825, ...
    -10.529913506705357924400555598453147999529577594621, ...
    -11.476953551278779437923464924732819671948253814888, ...
    -12.386417138582738745561901502863280948259798384686, ...
    -13.263639522941805554110743324395490775241151960981, ...
    -14.112756809068657791587309782224018471684042828551, ...
    -14.937057412154164040203214310490904639612176351778, ...
    -15.739210351190482770894978479748183380718016276784, ...
    -16.521419550634379053917949965210545716711031037058, ...
    -17.285531624581242532934236692253539242527975360271, ...
    -18.033113287225001572171112543339192000808729141641, ...
    -18.765508284480081041342978923610512844026718955142, ...
    -19.483880132989234013665998659241357512206297779361, ...
    -20.189244785396202420225323225827536076464978358393];
   
% roots of Ai'
Aip0 = [ ...
    -1.0187929716474710890173247833997438242182054412544, ...
    -3.2481975821798365378754237707758433841536230365172, ...
    -4.8200992111787356394006162604163794144626882314956, ...
    -6.1633073556394865476378435330914075929744838772035, ...
    -7.3721772550477701770921822711279890100201345609841, ...
    -8.4884867340197221328809954157307729511296435966841, ...
    -9.5354490524335474707026334270006396953882021716105, ...
    -10.527660396957407281978142491422228642986546369728, ...
    -11.475056633480245294937216522405638734755720848993, ...
    -12.384788371845747325493339235382624100992370194785, ...
    -13.262218961665210382437278421238129653666371233824, ...
    -14.111501970462995281632745953671914756595960575042, ...
    -14.935937196720517466507282053262794211179722552821, ...
    -15.738201373692538302686453230117245064669870517246, ...
    -16.520503825433793542205193089460628090312674013231, ...
    -17.284695050216437356643738423320821071650099098745, ...
    -18.032344622504393395265208622991537020979033367871, ...
    -18.764798437665954740151651210776010652875587884885, ...
    -19.483221656567231177524718047595025585947975834259, ...
    -20.188631509463373153654532142889269022602404329679];

% roots of Bi'
Bip0 = [ ...
    -2.2944396826141232466224586737691028290784894670097, ...
    -4.0731550890718282155523685150927099507931802704361, ...
    -5.5123957296635994962595925204791832430828826256323, ...
    -6.7812944459903053900286662961226871172477495824212, ...
    -7.9401786891685789266801550640446935823629502637863, ...
    -9.0195833587942390674148564392041050079302184045893, ...
    -10.037696334908545801757635529310886007196507089124, ...
    -11.006462667712289940421786739019088581440080565135, ...
    -11.934261645014844662801569666278840186207797864204, ...
    -12.827258309177217640185825158741726322623986320003, ...
    -13.690155826835049101230875300328438148375120657558, ...
    -14.52664576348571140952971574483676917698490608429, ...
    -15.33969308224240410861550731532421181298426399725, ...
    -16.131724782385900577888233513518963528011258988199, ...
    -16.904759411889649958231271910768490745514096181459, ...
    -17.660498743114976102193063216018487813946576657737, ...
    -18.400394367181703279815491774204536168443924692198, ...
    -19.125697156412638066113906473906703713766401673934, ...
    -19.837494718415910502933387611372870487592319138492, ...
    -20.536740241453273980113356181109303870747168422104];

switch K
    case 0
        % zeros of Ai(x)
        if ( ~any(N > 20) )
            % pretabulated values
            Z_N = Ai0( N );
        else           
            % this expansion is from A&S 10.4.94 as=-f[3*pi*(4s-1)/8]
            Z = 3*pi*(4.0*N - 1)/ 8.0;
            % the corresponding expansion, f(z), in A&S 10.4.105
            Z_N = -Z.^(2.0/3.0).*( 1 ...
                + (5.0/48)*(Z).^-2 ...
                - (5.0/36)*(Z).^-4 ...
                + (77125.0/82944.0)*(Z).^-6 ...
                - (108056875.0/6967296.0)*(Z).^-8 ...
                - (162375596875.0/334430208.0)*(Z).^-10);
            
            % pretabulated are more accurate, but the algorithm works well for N>10
            Z_N(N < 21) = Ai0( N(N < 21) );
        end
    case 1
        % zeros of Aip0(x)
        if ( ~any(N > 20) )
            % pretabulated values
            Z_N = Aip0( N );
        else           
            % this expansion is from A&S 10.4.95 as'=-g[3*pi*(4s-3)/8]
            Z = 3*pi*(4.0*N - 3.0)/ 8.0;
            % the corresponding expansion, g(z), in A&S 10.4.105
            Z_N = -Z.^(2.0/3.0).*( 1 ...
                - (7.0/48.0)*(1.0./Z).^2 ...
                + (35.0/288.0)*(Z).^-4 ...
                - (181223.0/207360.0)*(Z).^-6 ...
                + (18683371.0/1244169.0)*(Z).^-8 ...
                - (91145884361.0/191102976.0)*(Z).^-10);
            
            % pretabulated are more accurate, but the algorithm works well for N>10
            Z_N(N < 21) = Aip0( N(N < 21) );
        end
        
    case 2
        % zeros of Bi(x)
        if ( ~any(N > 20) )
            % pretabulated values
            Z_N = Bi0( N );
        else            
            % this expansion is from A&S 10.4.98, bs = -f[3*pi*(4s-3)/8]
            Z = 3*pi*(4.0*N - 3.0)/ 8.0;          
            % the corresponding expansion, f(z), in A&S 10.4.105
            Z_N = -Z.^(2.0/3.0).*( 1 ...
                + (5.0/48)*(Z).^-2 ...
                - (5.0/36)*(Z).^-4 ...
                + (77125.0/82944.0)*(Z).^-6 ...
                - (108056875.0/6967296.0)*(Z).^-8 ...
                - (162375596875.0/334430208.0)*(Z).^-10);
            
            % pretabulated are more accurate, but the algorithm 
            % works well for N>10
            Z_N(N < 21) = Bi0( N(N < 21) );
        end
        
    case 3
        % zeros of Bi'(x)
        if ( ~any(N > 20) )
            % pretabulated values
            Z_N = Bip0( N );
        else           
            % this expansion is from A&S 10.4.99 bs'=-g[3*pi*(4s-1)/8]
            Z = 3*pi*(4.0*N - 1.0)/ 8.0;
            % the corresponding expansion, g(z), in A&S 10.4.105
            Z_N = -Z.^(2.0/3.0).*( 1 ...
                - (7.0/48.0)*(1.0./Z).^2 ...
                + (35.0/288.0)*(Z).^-4 ...
                - (181223.0/207360.0)*(Z).^-6 ...
                + (18683371.0/1244169.0)*(Z).^-8 ...
                - (91145884361.0/191102976.0)*(Z).^-10);
            
            % pretabulated are more accurate
            Z_N(N < 21) = Bip0( N(N < 21) );
        end
        
end

end
